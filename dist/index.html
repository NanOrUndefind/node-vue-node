<!doctype html>
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Web Application</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="CDNAdd" content="{{ cdn('')|split('/?v=')[0] }}">
    <meta name="CDNVer" content="{{ cdn('')|split('/?v=')[1] }}">
    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <!-- <link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css"> -->
    <!-- needs images, font... therefore can not be part of ui.css -->
    <link rel="stylesheet" href="{{ cdn(['dist/common/css/main.css']|join) }}">

</head>
<body data-ng-app="app" id="app" data-custom-background="" data-off-canvas-nav="">
<!--[if lt IE 9]>
<p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade
    your browser</a> to improve your experience.</p>
<![endif]-->
<div class="page-signin">

    <div class="main-body" style="padding-top: 20%;">
        <div class="container">
            <div class="form-container">

                <section class="hide row signin-social text-center">
                    <a href="javascript:;" class="btn-icon btn-icon-sm bg-twitter"><i class="fa fa-twitter"></i></a>

                    <div class="space"></div>
                    <a href="javascript:;" class="btn-icon btn-icon-sm bg-facebook"><i class="fa fa-facebook"></i></a>

                    <div class="space"></div>
                    <a href="javascript:;" class="btn-icon btn-icon-sm bg-google-plus"><i class="fa fa-google-plus"></i></a>
                </section>

                <span class="line-thru hide">OR</span>

                <form class="form-horizontal" action="/api/admin/login" method="POST">
                    <fieldset>
                        <div class="form-group">
                            <div class="input-group input-group-lg">
                                <span class="input-group-addon">
                                    <span class="glyphicon glyphicon-user"></span>
                                </span>
                                <input type="text"
                                       name="name"
                                       class="form-control"
                                       placeholder="用户名"
                                        >
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="input-group input-group-lg">
                                <span class="input-group-addon">
                                    <span class="glyphicon glyphicon-lock"></span>
                                </span>
                                <input type="password" name="password"
                                       class="form-control"
                                       placeholder="密码"
                                        >
                            </div>
                        </div>
                        <div class="captcha-form" style="display:none;">
                            <div class="form-group">
                                <div class="input-group input-group-lg">
                                    <span class="input-group-addon">
                                        <span class="glyphicon glyphicon-lock"></span>
                                    </span>
                                    <input type="text" class="form-control" id="loginCaptcha" name="captcha"
                                           placeholder="请输入下方的验证码" disabled>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="input-group input-group-lg">
                                    <span class="input-group-addon" style="visibility: hidden;">
                                        <span class="glyphicon glyphicon-lock"></span>
                                    </span>
                                    <a id="reloadCaptcha" href="javascript:void(0)"><img class="captcha"
                                                                                         data-src="/admin/captcha?w=240&h=50"
                                                                                         src="/admin/captcha?w=240&h=50"
                                                                                         width="240" height="50"/></a>
                                </div>

                            </div>
                        </div>

                        <div class="form-group">
                            <button type="submit" class="btn btn-primary btn-lg btn-block">登 录</button>
                        </div>
                    </fieldset>
                </form>

                <!-- <section>
                    <p class="text-center"><a href="#/pages/forgot">Forgot your password?</a></p>
                    <p class="text-center text-muted text-small">Don't have an account yet? <a href="#/pages/signup">Sign up</a></p>
                </section> -->

            </div>
        </div>
    </div>

</div>
<!-- <canvas id="c" style="position: fixed; top: 0; z-index: -1;"></canvas> -->
<script src="//upcdn.b0.upaiyun.com/libs/jquery/jquery-2.0.3.min.js"></script>
<script>
    $(function () {
        $('form').submit(function (e) {
            e.preventDefault();
            var name = $('input[name="name"]').val();
            var passwd = $('input[name="password"]').val();
            var captcha = $('input[name="captcha"]').val();
            $.post('/api/admin/login?name=' + name + '&password=' + passwd + (captcha ? '&captcha=' + captcha : ''), function (d) {
                if (d.status === 0) {
                    location.href = '/';
                } else {
                    console.log(d.data[1])
                    if (d.data[1].retry > 3) {
                        $('.captcha-form').show().find('#loginCaptcha').removeAttr('disabled');
                    }
                }
            }, 'json');
        });


//     // link http://thecodeplayer.com/walkthrough/bouncing-squares-particle-system-basic-gravity
//     var c=document.getElementById('c');
//     var ctx=c.getContext('2d');

//     // full screen
//     c.height=window.innerHeight;
//     c.width=window.innerWidth;


//     var chinese="S E G M E N T F A U L T ";
//     // converting
//     chinese=chinese.split("");

//     var font_size=10;
//     var columns=c.width/font_size;

//     var drops=[];
//     for(var x=0;x<columns;x++){
//       drops[x]=1;
//     }

//     // drawing the characters
//     function draw(){
//       // black BG for the canvas
//       ctx.fillStyle="rgba(0,0,0,0.05)";
//       ctx.fillRect(0,0,c.width,c.height);

//       ctx.fillStyle="#0f0";
//       ctx.font=font_size+"px";

//       // looping over drops
//       for(var i=0;i<drops.length;i++){
//         var text=chinese[Math.floor(Math.random()*chinese.length)];
//         ctx.fillText(text,i*font_size,drops[i]*font_size);

//         if(drops[i]*font_size>c.height&&Math.random()>0.99){
//          drops[i]=0;
//         }

//         drops[i]++;
//       }
//     }

//     setInterval(draw,1000/30);

    });
</script>
</body>
</html>
